# Run.exe 程序说明

## 简介
Run.exe 是一个轻量级的启动工具，用于快速启动配置文件中指定的程序、文件或网址。它具有简洁的使用体验，类似 `Win+R` 运行命令，但提供了更多的灵活性和自动化功能。

## 功能特点

- ✅ **无命令行窗口**：启动时不显示任何命令行窗口，使用体验流畅
- ✅ **自动配置**：首次运行自动生成配置文件
- ✅ **智能识别**：自动识别网址和本地文件
- ✅ **默认打开方式**：使用Windows默认打开方式处理各种文件类型
- ✅ **自定义图标**：使用 `logo.png` 作为程序图标
- ✅ **错误提示**：目标不存在时显示友好的错误消息框
- ✅ **支持重命名**：支持重命名程序文件，配置文件会自动适配

## 使用方法

### 1. 获取程序
从 `dist` 目录中获取编译好的 `run.exe` 文件。

### 2. 运行程序
直接双击或在命令行中运行 `run.exe`。

### 3. 配置程序

首次运行 `run.exe` 时，会自动生成一个与程序同名的配置文件（例如：`run.ini`）。

配置文件格式：
```ini
; 配置文件范例
; target=要启动的程序/文件/网址路径
target=run/run.exe
```

#### 支持的配置项

| 配置项 | 说明 | 示例 |
|-------|------|------|
| target | 要启动的目标（程序/文件/网址） | `target=notepad.exe` |
|        | 支持本地文件路径 | `target=C:\Windows\System32\calc.exe` |
|        | 支持相对路径 | `target=run/run.exe` |
|        | 支持图片、文档等文件 | `target=image.jpg` |
|        | 支持带http的网址 | `target=http://www.baidu.com` |
|        | 支持带https的网址 | `target=https://www.google.com` |
|        | 支持带www的网址 | `target=www.example.com` |
|        | 支持不带前缀的网址 | `target=example.com` |

## 支持的文件类型

Run.exe 支持使用 Windows 默认打开方式打开各种类型的文件：

- **可执行文件**：`.exe`, `.bat`, `.cmd` 等
- **文档文件**：`.txt`, `.docx`, `.pdf`, `.ppt` 等
- **图片文件**：`.jpg`, `.png`, `.bmp`, `.gif` 等
- **音频视频**：`.mp3`, `.mp4`, `.avi`, `.wav` 等
- **压缩文件**：`.zip`, `.rar`, `.7z` 等
- **其他文件**：任何具有默认打开方式的文件

## 重命名支持

您可以将 `run.exe` 重命名为任何名称，程序会自动查找对应的配置文件：

- 例如：将 `run.exe` 重命名为 `start.exe`
- 程序会自动查找 `start.ini` 配置文件
- 默认配置中的 target 路径也会自动更新为 `start/start.exe`

## 编译方法（可选）

如果您需要修改源码并重新编译，可以使用以下命令：

```powershell
# 安装依赖
pip install pyinstaller pillow

# 编译命令
pyinstaller --onefile --icon=logo.png --noconsole run.py
```

编译后的文件会生成在 `dist` 目录中。

## 文件结构

```
.
├── run.py          # Python 源码文件
├── run.ini         # 配置文件
├── logo.png        # 程序图标
├── dist/           # 编译输出目录
│   └── run.exe     # 编译好的可执行文件
├── build/          # 编译临时文件目录
├── run.spec        # PyInstaller 配置文件
└── README.md       # 说明文档
```

## 注意事项

1. 配置文件必须与程序文件放在同一目录下
2. 程序会使用当前目录作为工作目录
3. 确保 `logo.png` 与源码文件在同一目录下（仅编译时需要）
4. 对于特殊字符路径，建议使用双引号包裹
5. 程序支持相对路径和绝对路径

## 错误提示

当目标不存在或无法启动时，程序会显示 Windows 错误消息框，包含详细的错误信息，帮助您排查问题。

## 版本历史

- **v1.0**：初始版本，支持启动程序
- **v1.1**：添加了自动生成配置文件功能
- **v1.2**：支持根据程序名自动查找配置文件
- **v1.3**：添加了无控制台窗口支持
- **v1.4**：添加了自定义图标支持
- **v1.5**：添加了网址识别和浏览器打开功能
- **v1.6**：添加了默认打开方式支持，可打开各种文件类型

## 联系方式

如有问题或建议，请联系开发者。
